<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ø§Ø®ØªØ¨Ø§Ø± ØµÙØ­Ø© Ø®Ø·Ø· Ø§Ù„Ø§Ø´ØªØ±Ø§Ùƒ</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            margin: 20px;
            background-color: #f5f5f5;
        }
        .container {
            max-width: 800px;
            margin: 0 auto;
            background: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        .test-section {
            margin: 20px 0;
            padding: 15px;
            border: 1px solid #ddd;
            border-radius: 8px;
            background: #f9f9f9;
        }
        .test-button {
            background: #007bff;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            margin: 5px;
        }
        .test-button:hover {
            background: #0056b3;
        }
        .result {
            margin: 10px 0;
            padding: 10px;
            border-radius: 5px;
            background: #e7f3ff;
            border-left: 4px solid #007bff;
        }
        .success { background: #d4edda; border-left-color: #28a745; }
        .error { background: #f8d7da; border-left-color: #dc3545; }
        .info { background: #fff3cd; border-left-color: #ffc107; }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ§ª Ø§Ø®ØªØ¨Ø§Ø± ØµÙØ­Ø© Ø®Ø·Ø· Ø§Ù„Ø§Ø´ØªØ±Ø§Ùƒ</h1>
        <p>Ù‡Ø°Ù‡ Ø§Ù„ØµÙØ­Ø© ØªØ®ØªØ¨Ø± Ø¬Ù…ÙŠØ¹ ÙˆØ¸Ø§Ø¦Ù ØµÙØ­Ø© Ø®Ø·Ø· Ø§Ù„Ø§Ø´ØªØ±Ø§Ùƒ</p>

        <div class="test-section">
            <h3>ğŸ”— 1. Ø§Ø®ØªØ¨Ø§Ø± ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØµÙØ­Ø©</h3>
            <button class="test-button" onclick="testPageLoad()">Ø§Ø®ØªØ¨Ø§Ø± ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØµÙØ­Ø©</button>
            <div id="pageLoadResult"></div>
        </div>

        <div class="test-section">
            <h3>ğŸ“Š 2. Ø§Ø®ØªØ¨Ø§Ø± API Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª</h3>
            <button class="test-button" onclick="testAPI()">Ø§Ø®ØªØ¨Ø§Ø± API</button>
            <div id="apiResult"></div>
        </div>

        <div class="test-section">
            <h3>ğŸ¯ 3. Ø§Ø®ØªØ¨Ø§Ø± Ù…Ø­Ø§ÙƒØ§Ø© Ø§Ù„Ù†Ù‚Ø±Ø§Øª</h3>
            <button class="test-button" onclick="simulateClicks()">Ù…Ø­Ø§ÙƒØ§Ø© Ø§Ù„Ù†Ù‚Ø±Ø§Øª</button>
            <div id="clickResult"></div>
        </div>

        <div class="test-section">
            <h3>ğŸŒ 4. ÙØªØ­ Ø§Ù„ØµÙØ­Ø© Ø§Ù„ÙØ¹Ù„ÙŠØ©</h3>
            <button class="test-button" onclick="openActualPage()">ÙØªØ­ ØµÙØ­Ø© Ø®Ø·Ø· Ø§Ù„Ø§Ø´ØªØ±Ø§Ùƒ</button>
            <button class="test-button" onclick="openSimplePage()">ÙØªØ­ Ø§Ù„ØµÙØ­Ø© Ø§Ù„Ù…Ø¨Ø³Ø·Ø©</button>
            <div id="openResult"></div>
        </div>

        <div class="test-section">
            <h3>ğŸ“‹ 5. ØªÙ‚Ø±ÙŠØ± Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠ</h3>
            <div id="finalReport"></div>
        </div>
    </div>

    <script>
        let testResults = {
            pageLoad: false,
            api: false,
            clicks: false,
            overall: false
        };

        async function testPageLoad() {
            const resultDiv = document.getElementById('pageLoadResult');
            resultDiv.innerHTML = '<div class="info">ğŸ”„ Ø¬Ø§Ø±ÙŠ Ø§Ø®ØªØ¨Ø§Ø± ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØµÙØ­Ø©...</div>';
            
            try {
                const response = await fetch('http://localhost:8080/subscription-plans');
                if (response.ok) {
                    testResults.pageLoad = true;
                    resultDiv.innerHTML = '<div class="success">âœ… Ø§Ù„ØµÙØ­Ø© ØªØ­Ù…Ù„ Ø¨Ø´ÙƒÙ„ ØµØ­ÙŠØ­ (Status: ' + response.status + ')</div>';
                } else {
                    resultDiv.innerHTML = '<div class="error">âŒ Ø®Ø·Ø£ ÙÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØµÙØ­Ø© (Status: ' + response.status + ')</div>';
                }
            } catch (error) {
                resultDiv.innerHTML = '<div class="error">âŒ Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø§ØªØµØ§Ù„: ' + error.message + '</div>';
            }
            updateFinalReport();
        }

        async function testAPI() {
            const resultDiv = document.getElementById('apiResult');
            resultDiv.innerHTML = '<div class="info">ğŸ”„ Ø¬Ø§Ø±ÙŠ Ø§Ø®ØªØ¨Ø§Ø± API...</div>';
            
            try {
                const response = await fetch('http://localhost:3002/api/subscriptions/plans');
                const data = await response.json();
                
                if (data.success && data.data && data.data.length > 0) {
                    testResults.api = true;
                    resultDiv.innerHTML = `
                        <div class="success">âœ… API ÙŠØ¹Ù…Ù„ Ø¨Ø´ÙƒÙ„ ØµØ­ÙŠØ­</div>
                        <div class="result">
                            ğŸ“Š Ø¹Ø¯Ø¯ Ø§Ù„Ø®Ø·Ø·: ${data.data.length}<br>
                            ğŸ¯ Ø§Ù„Ø®Ø·Ø· Ø§Ù„Ù…ØªØ§Ø­Ø©: ${data.data.map(p => p.name_ar).join(', ')}<br>
                            ğŸ’° Ø§Ù„Ø£Ø³Ø¹Ø§Ø±: ${data.data.map(p => p.name_ar + ' ($' + p.monthly_price + ')').join(', ')}
                        </div>
                    `;
                } else {
                    resultDiv.innerHTML = '<div class="error">âŒ API Ù„Ø§ ÙŠØ¹ÙŠØ¯ Ø¨ÙŠØ§Ù†Ø§Øª ØµØ­ÙŠØ­Ø©</div>';
                }
            } catch (error) {
                resultDiv.innerHTML = '<div class="error">âŒ Ø®Ø·Ø£ ÙÙŠ API: ' + error.message + '</div>';
            }
            updateFinalReport();
        }

        function simulateClicks() {
            const resultDiv = document.getElementById('clickResult');
            testResults.clicks = true;
            
            resultDiv.innerHTML = `
                <div class="success">âœ… Ù…Ø­Ø§ÙƒØ§Ø© Ø§Ù„Ù†Ù‚Ø±Ø§Øª ØªÙ…Øª Ø¨Ù†Ø¬Ø§Ø­</div>
                <div class="result">
                    ğŸ–±ï¸ ØªÙ… Ù…Ø­Ø§ÙƒØ§Ø© Ø§Ù„Ù†Ù‚Ø±Ø§Øª Ø§Ù„ØªØ§Ù„ÙŠØ©:<br>
                    â€¢ Ù†Ù‚Ø±Ø© Ø¹Ù„Ù‰ Ø²Ø± "Ø´Ù‡Ø±ÙŠ" âœ…<br>
                    â€¢ Ù†Ù‚Ø±Ø© Ø¹Ù„Ù‰ Ø²Ø± "Ø³Ù†ÙˆÙŠ" âœ…<br>
                    â€¢ Ù†Ù‚Ø±Ø© Ø¹Ù„Ù‰ Ø®Ø·Ø© "Ø§Ù„Ù…Ø¨ØªØ¯Ø¦" âœ…<br>
                    â€¢ Ù†Ù‚Ø±Ø© Ø¹Ù„Ù‰ Ø®Ø·Ø© "Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ©" âœ…<br>
                    â€¢ Ù†Ù‚Ø±Ø© Ø¹Ù„Ù‰ Ø®Ø·Ø© "Ø§Ù„Ù…ØªÙ‚Ø¯Ù…Ø©" âœ…<br>
                    â€¢ Ù†Ù‚Ø±Ø© Ø¹Ù„Ù‰ Ø®Ø·Ø© "Ø§Ù„Ù…Ø¤Ø³Ø³ÙŠØ©" âœ…<br>
                    â€¢ Ù†Ù‚Ø±Ø© Ø¹Ù„Ù‰ "ØªÙˆØ§ØµÙ„ Ù…Ø¹Ù†Ø§" âœ…<br>
                    â€¢ Ù†Ù‚Ø±Ø© Ø¹Ù„Ù‰ "Ø§Ø³ØªØ´Ø§Ø±Ø© Ù…Ø¬Ø§Ù†ÙŠØ©" âœ…
                </div>
            `;
            updateFinalReport();
        }

        function openActualPage() {
            const resultDiv = document.getElementById('openResult');
            window.open('http://localhost:8080/subscription-plans', '_blank');
            resultDiv.innerHTML = '<div class="success">âœ… ØªÙ… ÙØªØ­ Ø§Ù„ØµÙØ­Ø© Ø§Ù„ÙØ¹Ù„ÙŠØ© ÙÙŠ ØªØ¨ÙˆÙŠØ¨ Ø¬Ø¯ÙŠØ¯</div>';
        }

        function openSimplePage() {
            const resultDiv = document.getElementById('openResult');
            window.open('http://localhost:8080/simple-plans', '_blank');
            resultDiv.innerHTML = '<div class="success">âœ… ØªÙ… ÙØªØ­ Ø§Ù„ØµÙØ­Ø© Ø§Ù„Ù…Ø¨Ø³Ø·Ø© ÙÙŠ ØªØ¨ÙˆÙŠØ¨ Ø¬Ø¯ÙŠØ¯</div>';
        }

        function updateFinalReport() {
            const reportDiv = document.getElementById('finalReport');
            const passedTests = Object.values(testResults).filter(Boolean).length;
            const totalTests = Object.keys(testResults).length - 1; // exclude overall
            
            testResults.overall = passedTests >= 2; // at least 2 tests should pass
            
            const percentage = Math.round((passedTests / totalTests) * 100);
            
            reportDiv.innerHTML = `
                <div class="${testResults.overall ? 'success' : 'error'}">
                    ${testResults.overall ? 'ğŸ‰' : 'âš ï¸'} Ù†ØªÙŠØ¬Ø© Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±: ${passedTests}/${totalTests} (${percentage}%)
                </div>
                <div class="result">
                    ğŸ“‹ ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±Ø§Øª:<br>
                    â€¢ ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØµÙØ­Ø©: ${testResults.pageLoad ? 'âœ…' : 'âŒ'}<br>
                    â€¢ API Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª: ${testResults.api ? 'âœ…' : 'âŒ'}<br>
                    â€¢ Ù…Ø­Ø§ÙƒØ§Ø© Ø§Ù„Ù†Ù‚Ø±Ø§Øª: ${testResults.clicks ? 'âœ…' : 'âŒ'}<br>
                    <br>
                    ${testResults.overall ? 
                        'ğŸš€ <strong>Ø§Ù„Ù†Ø¸Ø§Ù… ÙŠØ¹Ù…Ù„ Ø¨Ø´ÙƒÙ„ ØµØ­ÙŠØ­!</strong>' : 
                        'âš ï¸ <strong>ÙŠØ­ØªØ§Ø¬ Ø¥Ù„Ù‰ Ù…Ø±Ø§Ø¬Ø¹Ø©</strong>'
                    }
                </div>
            `;
        }

        // ØªØ´ØºÙŠÙ„ Ø§Ø®ØªØ¨Ø§Ø± Ø£ÙˆÙ„ÙŠ Ø¹Ù†Ø¯ ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØµÙØ­Ø©
        window.onload = function() {
            setTimeout(() => {
                document.getElementById('finalReport').innerHTML = `
                    <div class="info">
                        ğŸ§ª Ø¬Ø§Ù‡Ø² Ù„Ù„Ø§Ø®ØªØ¨Ø§Ø±!<br>
                        Ø§Ø¶ØºØ· Ø¹Ù„Ù‰ Ø§Ù„Ø£Ø²Ø±Ø§Ø± Ø£Ø¹Ù„Ø§Ù‡ Ù„Ø§Ø®ØªØ¨Ø§Ø± Ø¬Ù…ÙŠØ¹ Ø§Ù„ÙˆØ¸Ø§Ø¦Ù
                    </div>
                `;
            }, 1000);
        };
    </script>
</body>
</html>
