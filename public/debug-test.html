<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ุชุดุฎูุต ุงููุดููุฉ</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            background: #f0f2f5;
            margin: 0;
            padding: 20px;
            direction: rtl;
        }
        
        .container {
            max-width: 800px;
            margin: 0 auto;
            background: white;
            border-radius: 10px;
            padding: 30px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        
        .header {
            text-align: center;
            background: #dc3545;
            color: white;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 30px;
        }
        
        .btn {
            background: #007bff;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            margin: 5px;
            font-size: 14px;
        }
        
        .btn:hover {
            background: #0056b3;
        }
        
        .btn.success { background: #28a745; }
        .btn.danger { background: #dc3545; }
        
        .debug-info {
            background: #f8f9fa;
            border: 1px solid #dee2e6;
            border-radius: 5px;
            padding: 15px;
            margin: 15px 0;
            font-family: monospace;
            white-space: pre-wrap;
        }
        
        .test-result {
            background: #e7f3ff;
            border: 1px solid #b3d9ff;
            border-radius: 5px;
            padding: 15px;
            margin: 15px 0;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>๐ ุชุดุฎูุต ูุดููุฉ ุงูุตูุญุงุช</h1>
            <p>ุงุฎุชุจุงุฑ ูุจุงุดุฑ ููู API</p>
        </div>
        
        <div>
            <h3>๐งช ุงุฎุชุจุงุฑ ุงูู API ูุจุงุดุฑุฉ:</h3>
            <button class="btn" onclick="testAPI()">ุงุฎุชุจุงุฑ ุฌูุจ ุงูุตูุญุงุช</button>
            <button class="btn success" onclick="testWithCompany('company-1')">ุงุฎุชุจุงุฑ Swan Shop</button>
            <button class="btn success" onclick="testWithCompany('company-2')">ุงุฎุชุจุงุฑ ุณููุง 127</button>
            <button class="btn danger" onclick="clearResults()">ูุณุญ ุงููุชุงุฆุฌ</button>
        </div>
        
        <div class="test-result">
            <h4>๐ ุงูุดุฑูุฉ ุงูุญุงููุฉ:</h4>
            <div id="currentCompany">ูุง ุชูุฌุฏ</div>
        </div>
        
        <div class="debug-info" id="debugInfo">
ุฌุงุฑู ุงูุชุญููู...
        </div>
        
        <div>
            <h3>๐ง ุฃุฏูุงุช ุงูุชุญูู:</h3>
            <button class="btn" onclick="setCompany('company-1')">ุชุนููู Swan Shop</button>
            <button class="btn" onclick="setCompany('company-2')">ุชุนููู ุณููุง 127</button>
            <button class="btn" onclick="setCompany('company-new')">ุชุนููู ุดุฑูุฉ ุฌุฏูุฏุฉ</button>
            <button class="btn" onclick="setCompany('new-company-123')">ุชุนููู ุงูุดุฑูุฉ ุงูุชุฌุฑูุจูุฉ</button>
            <button class="btn danger" onclick="clearCompany()">ูุณุญ ุงูุดุฑูุฉ</button>
        </div>

        <div style="background: #fff3cd; border: 1px solid #ffeaa7; border-radius: 5px; padding: 15px; margin: 15px 0;">
            <h4>๐ฏ ูุญู ุงููุดููุฉ:</h4>
            <p><strong>ุงููุดููุฉ:</strong> ุงูุดุฑูุฉ ุงูุญุงููุฉ (new-company-123) ูุงูุช ุบูุฑ ูุนุฑูุฉ ูู ุงููุธุงู</p>
            <p><strong>ุงูุญู:</strong> ุชู ุฅุถุงูุชูุง ูููุธุงู ุงูุขู</p>
            <p><strong>ุงุฎุชุจุฑ:</strong> ุงุถุบุท "ุชุนููู Swan Shop" ุซู ุงุฐูุจ ููุฅุนุฏุงุฏุงุช</p>
        </div>
        
        <div>
            <h3>๐ ุฑูุงุจุท ูููุฏุฉ:</h3>
            <a href="/settings" target="_blank" style="margin: 5px; padding: 10px; background: #17a2b8; color: white; text-decoration: none; border-radius: 5px;">ูุชุญ ุงูุฅุนุฏุงุฏุงุช</a>
            <a href="http://localhost:5173/settings" target="_blank" style="margin: 5px; padding: 10px; background: #6f42c1; color: white; text-decoration: none; border-radius: 5px;">ุฅุนุฏุงุฏุงุช Vite</a>
        </div>
    </div>

    <script>
        function updateCurrentCompany() {
            const companyData = localStorage.getItem('company');
            const div = document.getElementById('currentCompany');
            
            if (companyData) {
                try {
                    const company = JSON.parse(companyData);
                    div.innerHTML = `${company.name} (${company.id})`;
                } catch (error) {
                    div.innerHTML = 'ุฎุทุฃ ูู ูุฑุงุกุฉ ุงูุจูุงูุงุช';
                }
            } else {
                div.innerHTML = 'ูุง ุชูุฌุฏ ุดุฑูุฉ ูุญุฏุฏุฉ';
            }
        }

        async function testAPI() {
            const debugDiv = document.getElementById('debugInfo');
            debugDiv.innerHTML = '๐ ุฌุงุฑู ุงุฎุชุจุงุฑ ุงูู API...\n';
            
            try {
                // ุงุฎุชุจุงุฑ ุงูู API ุจุฏูู ููุชุฑุฉ
                const response = await fetch('/api/facebook/settings');
                const data = await response.json();
                
                debugDiv.innerHTML += `โ ูุฌุญ ุงูุงุชุตุงู ุจุงูู API\n`;
                debugDiv.innerHTML += `๐ ุนุฏุฏ ุงูุตูุญุงุช: ${data.length}\n`;
                debugDiv.innerHTML += `๐ ุงูุตูุญุงุช:\n`;
                
                data.forEach((page, index) => {
                    debugDiv.innerHTML += `   ${index + 1}. ${page.page_name || 'ุจุฏูู ุงุณู'} (${page.page_id})\n`;
                });
                
            } catch (error) {
                debugDiv.innerHTML += `โ ุฎุทุฃ ูู ุงูุงุชุตุงู: ${error.message}\n`;
            }
        }

        async function testWithCompany(companyId) {
            const debugDiv = document.getElementById('debugInfo');
            debugDiv.innerHTML = `๐ ุฌุงุฑู ุงุฎุชุจุงุฑ ุงูุดุฑูุฉ ${companyId}...\n`;
            
            try {
                // ุงุฎุชุจุงุฑ ุงูู API ูุน ููุชุฑุฉ ุงูุดุฑูุฉ
                const response = await fetch(`/api/facebook/settings?company_id=${companyId}`);
                const data = await response.json();
                
                debugDiv.innerHTML += `โ ูุฌุญ ุงูุงุชุตุงู ุจุงูู API\n`;
                debugDiv.innerHTML += `๐ข ุงูุดุฑูุฉ: ${companyId}\n`;
                debugDiv.innerHTML += `๐ ุนุฏุฏ ุงูุตูุญุงุช ุงููููุชุฑุฉ: ${data.length}\n`;
                debugDiv.innerHTML += `๐ ุงูุตูุญุงุช ุงููููุชุฑุฉ:\n`;
                
                if (data.length > 0) {
                    data.forEach((page, index) => {
                        debugDiv.innerHTML += `   ${index + 1}. ${page.page_name || 'ุจุฏูู ุงุณู'} (${page.page_id})\n`;
                    });
                } else {
                    debugDiv.innerHTML += `   ูุง ุชูุฌุฏ ุตูุญุงุช ููุฐู ุงูุดุฑูุฉ\n`;
                }
                
            } catch (error) {
                debugDiv.innerHTML += `โ ุฎุทุฃ ูู ุงูุงุชุตุงู: ${error.message}\n`;
            }
        }

        function setCompany(companyId) {
            const companies = {
                'company-1': { id: 'company-1', name: 'Swan Shop' },
                'company-2': { id: 'company-2', name: 'ุณููุง 127' },
                'company-new': { id: 'company-new', name: 'ุดุฑูุฉ ุฌุฏูุฏุฉ' },
                'new-company-123': { id: 'new-company-123', name: 'ุดุฑูุฉ ุชุฌุฑูุจูุฉ ุฌุฏูุฏุฉ' }
            };
            
            localStorage.setItem('company', JSON.stringify(companies[companyId]));
            updateCurrentCompany();
            
            const debugDiv = document.getElementById('debugInfo');
            debugDiv.innerHTML = `โ ุชู ุชุนููู ุงูุดุฑูุฉ: ${companies[companyId].name}\n`;
        }

        function clearCompany() {
            localStorage.removeItem('company');
            updateCurrentCompany();
            
            const debugDiv = document.getElementById('debugInfo');
            debugDiv.innerHTML = `๐งน ุชู ูุณุญ ุจูุงูุงุช ุงูุดุฑูุฉ\n`;
        }

        function clearResults() {
            document.getElementById('debugInfo').innerHTML = 'ุชู ูุณุญ ุงููุชุงุฆุฌ\n';
        }

        // ุชุญุฏูุซ ุงูุนุฑุถ ุนูุฏ ุชุญููู ุงูุตูุญุฉ
        document.addEventListener('DOMContentLoaded', () => {
            updateCurrentCompany();
            testAPI(); // ุงุฎุชุจุงุฑ ุชููุงุฆู ุนูุฏ ุงูุชุญููู
        });
        
        console.log('๐ ุชู ุชุญููู ุตูุญุฉ ุงูุชุดุฎูุต');
    </script>
</body>
</html>
