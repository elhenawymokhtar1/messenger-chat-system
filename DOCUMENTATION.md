# ๐ ุชูุซูู ูุดุฑูุน Facebook Reply Automator

## ๐ฏ ูุธุฑุฉ ุนุงูุฉ
ูุธุงู ุฑุฏ ุชููุงุฆู ุฐูู ูุตูุญุงุช Facebook ุจุงุณุชุฎุฏุงู Gemini AI ูุน ุฅุฏุงุฑุฉ ุงูุทูุจุงุช ูุฅุฑุณุงู ุงูุตูุฑ.

## ๐๏ธ ูููู ุงููุดุฑูุน

### ๐ ุงููููุงุช ุงูุฑุฆูุณูุฉ
```
src/
โโโ services/
โ   โโโ geminiAi.ts          # ุฎุฏูุฉ Gemini AI
โ   โโโ facebookApi.ts       # ุฎุฏูุฉ Facebook API
โ   โโโ orderService.ts      # ุฎุฏูุฉ ุฅุฏุงุฑุฉ ุงูุทูุจุงุช
โ   โโโ productImageService.ts # ุฎุฏูุฉ ุฅุฏุงุฑุฉ ุงูุตูุฑ
โโโ api/
โ   โโโ server.ts           # ุฎุงุฏู API ุงููุญูู
api/
โโโ process-message.js      # Webhook ููู Vercel
```

## โ๏ธ ุงูุฎุฏูุงุช ุงูุฃุณุงุณูุฉ

### 1. ๐ค Gemini AI Service (`geminiAi.ts`)
**ุงููุธุงุฆู ุงูุฑุฆูุณูุฉ:**
- `processIncomingMessage()` - ูุนุงูุฌุฉ ุงูุฑุณุงุฆู ุงููุงุฑุฏุฉ
- `generateResponse()` - ุชูููุฏ ุงูุฑุฏูุฏ ุงูุฐููุฉ
- `checkAndCreateOrder()` - ูุญุต ูุฅูุดุงุก ุงูุทูุจุงุช
- `sendImageToCustomer()` - ุฅุฑุณุงู ุงูุตูุฑ ููุนููุงุก

**ุงูุฅุนุฏุงุฏุงุช ุงููุทููุจุฉ:**
```typescript
interface GeminiSettings {
  api_key: string;
  model: string;
  prompt_template: string;
  is_enabled: boolean;
  max_tokens: number;
  temperature: number;
}
```

### 2. ๐ Facebook API Service (`facebookApi.ts`)
**ุงููุธุงุฆู ุงูุฑุฆูุณูุฉ:**
- `sendMessage()` - ุฅุฑุณุงู ุฑุณุงุฆู ูุตูุฉ
- `sendImage()` - ุฅุฑุณุงู ุงูุตูุฑ (URL + File Upload)
- `getPageMessages()` - ุฌูุจ ุฑุณุงุฆู ุงูุตูุญุฉ
- `saveFacebookSettings()` - ุญูุธ ุฅุนุฏุงุฏุงุช Facebook

**ุทุฑู ุฅุฑุณุงู ุงูุตูุฑ:**
1. **URL Attachment** (ุงูุทุฑููุฉ ุงูุฃููู)
2. **File Upload** (Fallback ุฅุฐุง ูุดูุช ุงูุฃููู)

### 3. ๐ฆ Order Service (`orderService.ts`)
**ุงููุธุงุฆู ุงูุฑุฆูุณูุฉ:**
- `extractCustomerInfo()` - ุงุณุชุฎุฑุงุฌ ุจูุงูุงุช ุงูุนููู
- `analyzeConversationForOrder()` - ุชุญููู ุงููุญุงุฏุซุฉ
- `createOrder()` - ุฅูุดุงุก ุทูุจ ุฌุฏูุฏ
- `isOrderDataComplete()` - ูุญุต ุงูุชูุงู ุงูุจูุงูุงุช

**ุงูุจูุงูุงุช ุงููุทููุจุฉ ููุทูุจ:**
- ุงูุงุณู
- ุฑูู ุงููุงุชู
- ุงูุนููุงู
- ุงูููุงุณ
- ุงูููู

### 4. ๐ค Simple Gemini Service (ูุจุณุท)
**ุงููุธุงุฆู ุงูุฑุฆูุณูุฉ:**
- `processMessage()` - ูุนุงูุฌุฉ ุงูุฑุณุงุฆู ุจู AI
- `getProductInfo()` - ุฌูุจ ูุนูููุงุช ุงูููุชุฌุงุช
- ุชู ุญุฐู ุฃูุธูุฉ ุงูุตูุฑ ูุงูุฃููุงู ุงููุนูุฏุฉ

## ๐ง ุฅุนุฏุงุฏ ุงููุธุงู

### 1. ูุชุบูุฑุงุช ุงูุจูุฆุฉ
```env
VITE_SUPABASE_URL=your_supabase_url
VITE_SUPABASE_ANON_KEY=your_supabase_key
GEMINI_API_KEY=your_gemini_api_key
```

### 2. ูุงุนุฏุฉ ุงูุจูุงูุงุช (Supabase)
**ุงูุฌุฏุงูู ุงููุทููุจุฉ:**
- `conversations` - ุงููุญุงุฏุซุงุช
- `messages` - ุงูุฑุณุงุฆู
- `orders` - ุงูุทูุจุงุช
- `auto_replies` - ุงูุฑุฏูุฏ ุงูุชููุงุฆูุฉ
- `facebook_settings` - ุฅุนุฏุงุฏุงุช Facebook
- ุชู ุญุฐู ุฌุฏุงูู ุงูุตูุฑ ูุงูุฃููุงู - ุงููุธุงู ูุจุณุท

### 3. Facebook Webhook
**URL:** `https://fbautoar.vercel.app/api/process-message`
**Verify Token:** `facebook_verify_token_123`
**Events:** messages, messaging_postbacks, messaging_optins

## ๐ ุชุดุบูู ุงููุธุงู

### ุงูุชุทููุฑ ุงููุญูู
```bash
# ุชุดุบูู ุงููุงุฌูุฉ
npm run dev

# ุชุดุบูู API ุงููุญูู
npm run api

# ุชุดุบูู ูู ุดูุก
npm run start:all
```

### ุงููุดุฑ
```bash
# ุฑูุน ุนูู GitHub
git add .
git commit -m "message"
git push origin main

# ุงููุดุฑ ุนูู Vercel ุชููุงุฆู
```

## ๐ ุงุณุชูุดุงู ุงูุฃุฎุทุงุก

### ูุดุงูู ุดุงุฆุนุฉ:

#### 1. ุงูุตูุฑ ูุง ุชูุฑุณู
**ุงูุฃุณุจุงุจ ุงููุญุชููุฉ:**
- ุฑุงุจุท ุงูุตูุฑุฉ ุบูุฑ ุตุญูุญ
- ูุดุงูู ูู Facebook API
- ูุดุงูู ูู ุงูุดุจูุฉ

**ุงูุญููู:**
- ุชุญูู ูู ุงูู logs ูู console
- ุชุฃูุฏ ูู ุตุญุฉ ุฑูุงุจุท ุงูุตูุฑ
- ุงููุธุงู ูุญุงูู File Upload ุชููุงุฆูุงู

#### 2. ุงูุทูุจุงุช ูุง ุชููุดุฃ
**ุงูุฃุณุจุงุจ ุงููุญุชููุฉ:**
- ุจูุงูุงุช ูุงูุตุฉ
- ูุดุงูู ูู ุงุณุชุฎุฑุงุฌ ุงูุจูุงูุงุช
- ูุดุงูู ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช

**ุงูุญููู:**
- ุชุญูู ูู logs ุงุณุชุฎุฑุงุฌ ุงูุจูุงูุงุช
- ุชุฃูุฏ ูู ุตุญุฉ ุฃููุงุท ุงููุตูุต
- ุชุญูู ูู ุงุชุตุงู ูุงุนุฏุฉ ุงูุจูุงูุงุช

#### 3. Webhook ูุง ูุนูู
**ุงูุฃุณุจุงุจ ุงููุญุชููุฉ:**
- ูุดุงูู ูู Vercel deployment
- ุฎุทุฃ ูู Verify Token
- ูุดุงูู ูู Facebook settings

**ุงูุญููู:**
- ุชุญูู ูู Vercel logs
- ุชุฃูุฏ ูู ุตุญุฉ Verify Token
- ุฃุนุฏ ุฅุนุฏุงุฏ Facebook Webhook

## ๐ ูุฑุงูุจุฉ ุงููุธุงู

### Logs ูููุฉ ูููุฑุงูุจุฉ:
```javascript
// ูู geminiAi.ts
console.log('๐ Extracted customer info:', customerInfo);
console.log('โ Order created successfully:', newOrder.order_number);

// ูู facebookApi.ts
console.log('๐ค Facebook API response:', response.status);
console.log('โ Image sent successfully');

// ูู orderService.ts
console.log('๐ Current message extracted info:', currentMessageInfo);
```

### ูุคุดุฑุงุช ุงูุฃุฏุงุก:
- ุนุฏุฏ ุงูุฑุณุงุฆู ุงููุนุงูุฌุฉ
- ุนุฏุฏ ุงูุทูุจุงุช ุงูููุดุฃุฉ
- ูุนุฏู ูุฌุงุญ ุฅุฑุณุงู ุงูุตูุฑ
- ุฃููุงุช ุงูุงุณุชุฌุงุจุฉ

## ๐ ุงูุฃูุงู

### ููุงุท ูููุฉ:
- ูุง ุชุดุงุฑู API Keys ูู ุงูููุฏ
- ุงุณุชุฎุฏู ูุชุบูุฑุงุช ุงูุจูุฆุฉ
- ุชุญูู ูู ุตุญุฉ ุงูุจูุงูุงุช ุงููุงุฑุฏุฉ
- ุฑุงูุจ ุงูู logs ููุฃูุดุทุฉ ุงููุดุจููุฉ

## ๐ ุงูุฏุนู ูุงูุตูุงูุฉ

### ููุตูุงูุฉ ุงูุฏูุฑูุฉ:
1. ุชุญุฏูุซ dependencies
2. ูุฑุงุฌุนุฉ ุงูู logs
3. ุชุญุฏูุซ prompts ุงูู AI
4. ูุณุฎ ุงุญุชูุงุทู ููุงุนุฏุฉ ุงูุจูุงูุงุช
5. ูุฑุงูุจุฉ ุงุณุชููุงู API

### ูููุดุงูู ุงูุทุงุฑุฆุฉ:
1. ุชุญูู ูู Vercel status
2. ุชุญูู ูู Supabase status
3. ุชุญูู ูู Facebook API status
4. ุฑุงุฌุน ุงูู logs ุงูุฃุฎูุฑุฉ
5. ุฃุนุฏ ุชุดุบูู ุงูุฎุฏูุงุช ุฅุฐุง ูุฒู ุงูุฃูุฑ
